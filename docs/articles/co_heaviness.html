<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Co-heaviness of two parent packages • pkgndep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Co-heaviness of two parent packages">
<meta property="og:description" content="pkgndep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pkgndep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/pkgndep.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/co_heaviness.html">Co-heaviness of two parent packages</a>
    </li>
    <li>
      <a href="../articles/suggestions.html">Suggestions for optimizing package dependencies</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/pkgndep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Co-heaviness of two parent packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/pkgndep/blob/HEAD/vignettes/co_heaviness.Rmd" class="external-link"><code>vignettes/co_heaviness.Rmd</code></a></small>
      <div class="hidden name"><code>co_heaviness.Rmd</code></div>

    </div>

    
    
<p>The heaviness measures the number of additional dependency packages that a parent package uniquely imports, which are the dependency packages not imported by any of the other parent packages. However, there are scenarios when multiple parents import similar sets of dependencies, which results in heaviness for individual parent being very small.</p>
<p>We take the <strong>DESeq2</strong> package as an example. First we generate the dependency heatmap.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/pkgndep" class="external-link">pkgndep</a></span><span class="op">)</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/pkgndep.html">pkgndep</a></span><span class="op">(</span><span class="st">"DESeq2"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="co_heaviness_files/figure-html/unnamed-chunk-4-1.png" width="1200px" style="display: block; margin: auto;"></p>
<p>You can drag the plot into a new tab if it is too small to read.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># or create the plot in an HTML page</span>
<span class="co"># dependency_report(x)</span></code></pre></div>
<p>As can be observed from the heatmap, <strong>DESeq2</strong>’s two parents <strong>geneplotter</strong> and <strong>genefilter</strong> (the last two rows in “Imports” category in the heatmap) import 51 and 53 dependency packages, among them 50 packages are the same. Due to the high overlap, the heaviness of <strong>geneplotter</strong> and <strong>genefilter</strong> on <strong>DESeq2</strong> are only 1 and 2 respectively. However, if taking the two parents together, i.e., by moving both parents to “Suggests” of <strong>DESeq2</strong>, 23 dependency packages can be reduced.</p>
<p>Here we define <strong>the co-heaviness</strong> that measures the number of additional dependency packages brought by two parent packages. Denote a package as <em>P</em> and its two strong parent packages as <em>A</em> and <em>B</em>, i.e., parent packages in “Depends”, “Imports” and “LinkingTo”, denote <span class="math inline">\(S_A\)</span> as the set of reduced dependency packages when only moving <em>A</em> to “Suggests” of <em>P</em>, denote <span class="math inline">\(S_B\)</span> as the set of reduced dependency packages when only moving <em>B</em> to “Suggests” of <em>P</em>, and denote <span class="math inline">\(S_{AB}\)</span> as the set of reduced dependency packages when moving <em>A</em> and <em>B</em> together to “Suggests” of <em>P</em>, the co-heaviness of <em>A</em>, <em>B</em> on <em>P</em> is calculatd as</p>
<p><span class="math display">\[ \left | S_{AB} \setminus  \cup (S_A, S_B) \right | \]</span></p>
<p>which is the number of reduced package only caused by co-action of A and B. Symbol <span class="math inline">\(A \setminus B\)</span> is the set of elements in <em>A</em> not in <em>B</em> and <span class="math inline">\(|A|\)</span> is the number of elements in set <em>A</em>.</p>
<p>Denote <span class="math inline">\(h_A\)</span> as the heaviness of <em>A</em> (as a strong parent) on <em>P</em>, <span class="math inline">\(h_B\)</span> as the heaviness of <em>B</em> (as a strong parent) on <em>P</em>, and <span class="math inline">\(h_{AB}\)</span> as the co-heaviess of <em>A</em>/<em>B</em> on <em>P</em>, the number of reduced strong dependencies by moving both <em>A</em> and <em>B</em> to <em>P</em>’s “Suggests” is:</p>
<p><span class="math display">\[ h_A + h_B + h_{AB} \]</span></p>
<p><strong>pkgndep</strong> provides a function <code><a href="../reference/co_heaviness.html">co_heaviness()</a></code> that calculates co-heaviness of two parent packages. It returns a co-heaviness matrix. Please note it only returns the matrix for strong parents.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/co_heaviness.html">co_heaviness</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">m</span></code></pre></div>
<pre><code><span class="co">##                      S4Vectors IRanges GenomicRanges SummarizedExperiment</span>
<span class="co">## S4Vectors                    0       0             0                    0</span>
<span class="co">## IRanges                      0       0             0                    0</span>
<span class="co">## GenomicRanges                0       0             0                    1</span>
<span class="co">## SummarizedExperiment         0       0             1                    4</span>
<span class="co">## methods                      0       0             0                    0</span>
<span class="co">## stats4                       0       0             0                    0</span>
<span class="co">## Rcpp                         0       0             0                    0</span>
<span class="co">## BiocGenerics                 0       0             0                    0</span>
<span class="co">## Biobase                      0       0             0                    0</span>
<span class="co">## locfit                       0       0             0                    0</span>
<span class="co">## BiocParallel                 0       0             0                    0</span>
<span class="co">## ggplot2                      0       0             0                    0</span>
<span class="co">## geneplotter                  0       0             0                    0</span>
<span class="co">## genefilter                   0       0             0                    0</span>
<span class="co">## RcppArmadillo                0       0             0                    0</span>
<span class="co">##                      methods stats4 Rcpp BiocGenerics Biobase locfit</span>
<span class="co">## S4Vectors                  0      0    0            0       0      0</span>
<span class="co">## IRanges                    0      0    0            0       0      0</span>
<span class="co">## GenomicRanges              0      0    0            0       0      0</span>
<span class="co">## SummarizedExperiment       0      0    0            0       0      0</span>
<span class="co">## methods                    0      0    0            0       0      0</span>
<span class="co">## stats4                     0      0    0            0       0      0</span>
<span class="co">## Rcpp                       0      0    0            0       0      0</span>
<span class="co">## BiocGenerics               0      0    0            0       0      0</span>
<span class="co">## Biobase                    0      0    0            0       0      0</span>
<span class="co">## locfit                     0      0    0            0       0      1</span>
<span class="co">## BiocParallel               0      0    0            0       0      0</span>
<span class="co">## ggplot2                    0      0    0            0       0      0</span>
<span class="co">## geneplotter                0      0    0            0       0      0</span>
<span class="co">## genefilter                 0      0    0            0       0      0</span>
<span class="co">## RcppArmadillo              0      0    0            0       0      0</span>
<span class="co">##                      BiocParallel ggplot2 geneplotter genefilter RcppArmadillo</span>
<span class="co">## S4Vectors                       0       0           0          0             0</span>
<span class="co">## IRanges                         0       0           0          0             0</span>
<span class="co">## GenomicRanges                   0       0           0          0             0</span>
<span class="co">## SummarizedExperiment            0       0           0          0             0</span>
<span class="co">## methods                         0       0           0          0             0</span>
<span class="co">## stats4                          0       0           0          0             0</span>
<span class="co">## Rcpp                            0       0           0          0             0</span>
<span class="co">## BiocGenerics                    0       0           0          0             0</span>
<span class="co">## Biobase                         0       0           0          0             0</span>
<span class="co">## locfit                          0       0           0          0             0</span>
<span class="co">## BiocParallel                    8       0           0          0             0</span>
<span class="co">## ggplot2                         0      21           1          1             0</span>
<span class="co">## geneplotter                     0       1           1         23             0</span>
<span class="co">## genefilter                      0       1          23          2             0</span>
<span class="co">## RcppArmadillo                   0       0           0          0             1</span>
<span class="co">## attr(,"max")</span>
<span class="co">## [1] 23</span>
<span class="co">## attr(,"max_pair")</span>
<span class="co">## [1] "genefilter"  "geneplotter"</span></code></pre>
<p>The co-heaviness matrix can be visualized as a heatmap.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">m</span>, name <span class="op">=</span> <span class="st">"co-heaviness"</span><span class="op">)</span></code></pre></div>
<p><img src="co_heaviness_files/figure-html/unnamed-chunk-7-1.png" width="624" style="display: block; margin: auto;"></p>
<p>There are two major reasons for the high co-heaviness from two parent packages. 1. Parent <em>A</em> also depends on package <em>B</em>, thus all the dependency packages brought by package <em>B</em> will also be included in the dependency packages from package <em>A</em>. E.g., package <strong>ffpe</strong>’s two parents <strong>lumi</strong> and <strong>methylumi</strong> where <strong>lumi</strong> also depends on <strong>methylumi</strong> and most of the heaviness comes from <strong>methylummi</strong>. 2. Although <em>A</em> and <em>B</em> do not depend on each other, they have a common upstream package, which brings the same dependencies to A and B. Such as the example of <strong>DESeq2</strong>, its two parent packages <strong>geneplotter</strong> and <strong>genefilter</strong> have a common upstream pacakge <strong>annotate</strong> that contribute many dependencies to both package.</p>
<p>Alternatively, the co-heaviness can also be defined as a relative measure, the Jaccard coeffcient. Note <span class="math inline">\(S_{AB} \setminus \cup (S_A, S_B)\)</span> is actually the set of dependencies that are imported simultaneously by and only by two parent packages A and B. Thus the Jaccard coeffcient is calculated as:</p>
<p><span class="math display">\[ \frac{ \left | S_{AB} \setminus  \cup (S_A, S_B) \right | }{ \left | S_{AB} \right |  } \]</span></p>
<p>Or using the denotation of heaviness defined before, the Jaccard coeffcient can also be written as:</p>
<p><span class="math display">\[ \frac{h_{AB}}{h_A + h_B + h_{AB}} \]</span></p>
<p>The Jaccard coeffcient can be calculated by setting argument <code>jaccard = TRUE</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/co_heaviness.html">co_heaviness</a></span><span class="op">(</span><span class="va">x</span>, jaccard <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                      S4Vectors IRanges GenomicRanges SummarizedExperiment</span>
<span class="co">## S4Vectors                    0       0           0.0                  0.0</span>
<span class="co">## IRanges                      0       0           0.0                  0.0</span>
<span class="co">## GenomicRanges                0       0           0.0                  0.2</span>
<span class="co">## SummarizedExperiment         0       0           0.2                  1.0</span>
<span class="co">## methods                      0       0           0.0                  0.0</span>
<span class="co">## stats4                       0       0           0.0                  0.0</span>
<span class="co">## Rcpp                         0       0           0.0                  0.0</span>
<span class="co">## BiocGenerics                 0       0           0.0                  0.0</span>
<span class="co">## Biobase                      0       0           0.0                  0.0</span>
<span class="co">## locfit                       0       0           0.0                  0.0</span>
<span class="co">## BiocParallel                 0       0           0.0                  0.0</span>
<span class="co">## ggplot2                      0       0           0.0                  0.0</span>
<span class="co">## geneplotter                  0       0           0.0                  0.0</span>
<span class="co">## genefilter                   0       0           0.0                  0.0</span>
<span class="co">## RcppArmadillo                0       0           0.0                  0.0</span>
<span class="co">##                      methods stats4 Rcpp BiocGenerics Biobase locfit</span>
<span class="co">## S4Vectors                  0      0    0            0       0      0</span>
<span class="co">## IRanges                    0      0    0            0       0      0</span>
<span class="co">## GenomicRanges              0      0    0            0       0      0</span>
<span class="co">## SummarizedExperiment       0      0    0            0       0      0</span>
<span class="co">## methods                    0      0    0            0       0      0</span>
<span class="co">## stats4                     0      0    0            0       0      0</span>
<span class="co">## Rcpp                       0      0    0            0       0      0</span>
<span class="co">## BiocGenerics               0      0    0            0       0      0</span>
<span class="co">## Biobase                    0      0    0            0       0      0</span>
<span class="co">## locfit                     0      0    0            0       0      1</span>
<span class="co">## BiocParallel               0      0    0            0       0      0</span>
<span class="co">## ggplot2                    0      0    0            0       0      0</span>
<span class="co">## geneplotter                0      0    0            0       0      0</span>
<span class="co">## genefilter                 0      0    0            0       0      0</span>
<span class="co">## RcppArmadillo              0      0    0            0       0      0</span>
<span class="co">##                      BiocParallel    ggplot2 geneplotter genefilter</span>
<span class="co">## S4Vectors                       0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## IRanges                         0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## GenomicRanges                   0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## SummarizedExperiment            0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## methods                         0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## stats4                          0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## Rcpp                            0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## BiocGenerics                    0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## Biobase                         0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## locfit                          0 0.00000000  0.00000000 0.00000000</span>
<span class="co">## BiocParallel                    1 0.00000000  0.00000000 0.00000000</span>
<span class="co">## ggplot2                         0 1.00000000  0.04347826 0.04166667</span>
<span class="co">## geneplotter                     0 0.04347826  1.00000000 0.88461538</span>
<span class="co">## genefilter                      0 0.04166667  0.88461538 1.00000000</span>
<span class="co">## RcppArmadillo                   0 0.00000000  0.00000000 0.00000000</span>
<span class="co">##                      RcppArmadillo</span>
<span class="co">## S4Vectors                        0</span>
<span class="co">## IRanges                          0</span>
<span class="co">## GenomicRanges                    0</span>
<span class="co">## SummarizedExperiment             0</span>
<span class="co">## methods                          0</span>
<span class="co">## stats4                           0</span>
<span class="co">## Rcpp                             0</span>
<span class="co">## BiocGenerics                     0</span>
<span class="co">## Biobase                          0</span>
<span class="co">## locfit                           0</span>
<span class="co">## BiocParallel                     0</span>
<span class="co">## ggplot2                          0</span>
<span class="co">## geneplotter                      0</span>
<span class="co">## genefilter                       0</span>
<span class="co">## RcppArmadillo                    1</span>
<span class="co">## attr(,"max")</span>
<span class="co">## [1] 0.8846154</span>
<span class="co">## attr(,"max_pair")</span>
<span class="co">## [1] "genefilter"  "geneplotter"</span></code></pre>
<p>But users need to be careful that a small value of <span class="math inline">\(|S_{AB}|\)</span> may lead to a large Jaccard coeffcient value.</p>
<p>Finally, co-heaviness captures additional dependency packages from and only from two parents, while it does work for more parents. However, the effect of heaviness from multiple parents can always be easily observed from the dependency heatmap.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
